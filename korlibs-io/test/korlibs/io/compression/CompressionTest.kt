@file:Suppress("UnusedImport")

package korlibs.io.compression

import korlibs.encoding.*
import korlibs.io.async.suspendTest
import korlibs.io.compression.deflate.GZIP
import korlibs.memory.*
import kotlin.test.Test
import kotlin.test.assertEquals

class CompressionTest {
	@Test
	fun name() = suspendTest {
        val data =
            "H4sIAAAAAAAAA+3SsREAEBSD4WcFm2ACTID9dxGFxgDcub/4mjQpEmdmDuYPKwsSJT3qz1KkXu7fWZMu4/IGr78AAAAAAD+a6ywcnAAQAAA=".fromBase64()
        val res = data.uncompress(GZIP)
        val res2 = res.getS32ArrayLE(0, 4096 / 4)
        assertEquals(
            "" +
                    "1111111111111111111111111111111111111111111111111111111111111111111818181814950511111111111111111111111111818181816566671111111" +
                    "1111111111111111118181811818283111111111111111111111111118181111111111111111111111111111111111111111111111111111111111111111111" +
                    "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                    "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                    "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                    "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                    "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                    "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                    "111111111111111111111111111111",
            res2.toList().joinToString("")
        )
    }

    @Test
    fun test() {
        val uncompressedBytes = byteArrayOf(1, 2, 3, 4, 5)
        val compressedBytes = GZIP.compress(uncompressedBytes)
        val bytes = GZIP.uncompress(compressedBytes)
        assertEquals(bytes.hex, uncompressedBytes.hex)
    }
}
